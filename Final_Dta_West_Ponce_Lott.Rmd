---
title: "Final dta - Data Science"
author: "Andr√©s Ponce, Ben West, William Lott"
output: 
  html_document:
    toc: true # table of content true
    toc_depth: 3  # upto three depths of headings (specified by #, ## and ###)
    number_sections: true  ## if you want number sections at each table header
    theme: united  # many options for theme, this one is my favorite.
---
#Packages
install.packages("WDI")
library(WDI)
install.packages("dplyr")
library("dplyr")
install.packages("plyr")
library(plyr)
install.packages("ggplot2")
library(ggplot2)

#Preparting the Data
dat = WDI(indicator=c('NY.GDP.PCAP.KD', "SP.POP.TOTL", "MS.MIL.XPND.GD.ZS"), country='all', start=1960, end=2017)
dat <- dat[complete.cases(dat),]
dat2 <- dat
dat2 <- dat2[!duplicated(dat2[,c("country")]),]
country=c('MX','CA','US')

ccodes <- c("V2","1A", "4E", "T4", "XC", "7E", "T7", "EU", "F1", "XE", "XD", "XF", "ZT", "XH", "XI", "XG", "LA", "V3", "XJ", "T2", "XL", "XO", "XM", "XN", "XQ", "T3", "XP", "OE", "S4", "S2", "V4", "V1", "S1", "T5", "ZF", "XT", "1W")

#create new dataframe
milexp <- dat %>% filter(!iso2c %in% ccodes)

#rename variables
milexp <- rename(milexp, c("NY.GDP.PCAP.KD"="GDP", "SP.POP.TOTL"="Population","MS.MIL.XPND.GD.ZS"="Military Exp"))

 
# Research Question

# Variables


# Hypothesis


# Method

# Analysis
# scatterplo, it's ugly need it fix it
ggplot(milexp, aes(x=year, y=Military.Exp)) +
  geom_point(size=1, shape=23)

# analyzing regions
milexp %>%
  filter(iso2c == c('8S', 'ZG', 'Z4', "ZQ", "Z7", "ZJ", "XU")) %>%
  ggplot() + geom_line(mapping = aes(year, Military.Exp, 
                                     group=country, color=country)) +
  labs(y = 'Military Expenditures (% of GDP)') +
  ggtitle(paste('Regional Military Expenditure Comparison'))
  
# analyzing US, China, and India
milexp %>%
  filter(iso2c == c('US', 'IN', 'CN')) %>%
  ggplot() + geom_line(mapping = aes(year, Military.Exp, 
                                     group=country, color=country)) +
  labs(y = 'Military Expenditures (% of GDP)') +
  ggtitle(paste('Military Expenditure comparison of US, India and China'))


# initial code for heatmap, this is ben's doing
milexp <- milexp %>% mutate(`Raw expenditure`= GDP*Population*(`Military.Exp`/100)) %>% group_by(year) %>% 
  dplyr::mutate(`Mean expenditure (%)`=mean(`Military.Exp`)) %>% 
  dplyr::mutate(`Mean raw expenditure ($)`=mean(`Raw expenditure`)) %>% 
  dplyr::mutate(`Mean raw difference`=`Raw expenditure`-`Mean raw expenditure ($)`) %>% 
  dplyr::mutate('Mean pctg difference'=`Military.Exp`-`Mean expenditure (%)`)
# New Line
